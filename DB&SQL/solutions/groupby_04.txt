WITH RECURSIVE TIMETABLE AS (
    SELECT 0 AS h
    UNION ALL
    SELECT h+1 FROM TIMETABLE WHERE h < 23
)

# WITH과 RECURSIVE를 이용해 임시 테이블 만들기

SELECT h, COUNT(ANIMAL_ID) AS COUNT
FROM TIMETABLE
    LEFT OUTER JOIN ANIMAL_OUTS
    ON HOUR(DATETIME) = TIMETABLE.h
group by h
order by h